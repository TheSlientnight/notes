# 导航栏
1. 获取项目列表
- 说明: 通过token判断用户权限,返回项目列表
- api: `/get_project`
- method: get
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
- Response
```json
{
    "data": [
        {
            "name": "项目1", 
            "id": 1
        },{
            "name": "项目2", 
            "id": 2
        },{
            "name": "项目3", 
            "id": 3
        }
    ],
    "success": true
}
```

# 登录
1. 登录
- 说明: 请求登录,后端返回权限列表,个人信息,是否首次登录,token
- api: `/login`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "account": "admin",
    "password" : "584ac7e1e756e7f5414f4f989f52061b"
}
```
- Response
```json
{
    "data": {
        "permission": {
            "1": [11, 12 ,15],
            "2": [24, 25, 29],
            "3": [31, 32, 33]
        },
        "info": {
            "account": "admin",
            "name": "xiaoming",
            "user_id": 30,
            "phone": "13013017222",
            "role": "admin",
            "status": true
        },
        "is_first": true,
        "token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9",
    },
    "success": true
}
```

# dashboard
1. 获取dashboard数据
- 说明: 后台根据权限返回相关数据
- api: `/dashboard`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "project": 1
}
```
- Response
```json
{
    "data": {
        "template": {
            "total": 99,
            "increase": 20
            },
        "cases": {
            "total": 400,
            "increase": 80,
            "tswk_execution": 870,
            "total_execution": 9000
        },
        "suite": {
            "total": 200,
            "increase": 10,
            "tswk_execution": 87,
            "total_execution": 2000
        },
        "timer": {
            "total": 30,
            "increase": 2,
            "tswk_execution": 60,
            "total_execution": 500
        },
        "failure_list": [
            {
                "order": 1,
                "id": 23,
                "name": "login",
                "suite": 44,
                "count": 30
            }
        ],
        "timer_list": [
            {
                "id": 23,
                "name": "login",
                "regulation": "* * * * 1 ?",
                "next_date": "2021-05-01 23:26:00",
                "manager": 123
            }
        ],
    },
    "success": true
}
```


# 接口测试

## 模块
1. 获取模块列表
- 说明: 增加模块
- api: `/module`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "type": "template"
}
```
- Response
```json
{
    "data":{
        "module":[
            {
                "name":"一级模块",
                "level":1,
                "id":1,
                "child":[
                    {
                        "name":"二级模块1",
                        "level":2,
                        "id":11,
                        "child":[
                            {
                                "name":"三级模块1",
                                "level":3,
                                "id":111
                            },
                            {
                                "name":"三级模块2",
                                "level":3,
                                "id":112
                            }
                        ]
                    },
                    {
                        "name":"二级模块2",
                        "level":2,
                        "id":12,
                        "child":[
                            {
                                "name":"三级模块1",
                                "level":3,
                                "id":113
                            },
                            {
                                "name":"三级模块2",
                                "level":3,
                                "id":114
                            }
                        ]
                    }
                ]
            },
            {
                "name":"一级模块2",
                "level":1,
                "id":2
            }
        ]
    },
    "success":true
}
```
2. 增加模块
- 说明: 增加模块
- api: `/add_module`
- method: add
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "type": "template",
    "parent": 2,
    "name": "模块1"
}
```
- Response
```json
{
    "success": true
}
```
3. 删除模块
- 说明: 删除模块
- api: `/delete_module`
- method: delete
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "id": 3
}
```
- Response
```json
{
    "success": true
}
```
4. 编辑模块
- 说明: 删除模块
- api: `/delete_module`
- method: update
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "id": 3,
    "name": "新名字"
}
```
- Response
```json
{
    "success": true
}
```
## 接口模板
### 接口列表
1. 获取接口列表
- 说明: 获取接口列表
- api: `/api`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "module_id": 2,
    "page": 1
}
```
- Response
```json
{
    "data": {
        "api": [
            {
                "id": 1,
                "name": "接口1",
                "update_date": "2021-05-01 23:26:00",
                "create_date": "2021-05-01 23:26:00",
                "status": true,
                "relation": 3
            },
            {
                "id": 2,
                "name": "接口2",
                "update_date": "2021-05-01 23:26:00",
                "create_date": "2021-05-01 23:26:00",
                "status": true,
                "relation": 5
            }
        ]
    },
    "success": true,
    "next_page": 2,
    "total_page": 20
}
```
2. 删除接口模板
- 说明: 删除接口模板, 支持批量删除
- api: `/delete_api`
- method: delete
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "id": [2, 3, 4, 5]
}
```
- Response
```json
{
    "success": true
}
```
### 关联用例
1. 查看接口关联用例列表
- 说明: 查看接口关联用例列表
- api: `/relation_cases`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "id": 2
}
```
- Response
```json
{
    "data": {
        "cases": [
            {
                "id": 3,
                "name": "正常登录",
                "level": 1,
                "near_status": true,
                "desc": "这是个登录的正向用例"
            },
                        {
                "id": 4,
                "name": "密码错误登录",
                "level": 2,
                "near_status": true,
                "desc": "这是个登录的反向用例"
            }
        ]
    },
    "success": true
}
```
2. 查看接口关联用例信息
- 说明: 查看接口关联用例列表
- api: `/relation_info`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "id": 2
}
```
- Response
```json
{
    "data": {
        "info": {
            "path": "",
            "name": "",
            "count": 30,
            "success_rate": 0.5
        }
    },
    "success": true
}
```
3. 删除用例


### 接口模板详情
1. 添加接口模板
- 说明: 添加接口模板
    - status中1为未开始,2为进行中,3为已完成
    - reuqest中如果是get则可以有query,如果是post
    - method如果为file则是文件
- api: `/add_api`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "info":{
        "name": "登录",
        "manager": 12,
        "author": 3,
        "module": 22,
        "status": 1,
        "path": "/login",
        "desc": "登录接口",
        "env": 3,
    },
    "request": {
        "method": "post",
        "headers": {
            "token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9",
            "Content-Type": "application/json"
        },
        "query": {

        },
        "body": {
            "account":123456,
            "password":123456
        },
        "file": {
            "file_id": 123,
            "param": {
                "use_type": "SalaryImg"
                }
        }
    }
}
```
- Response
```json
{
    "success": true,
    "id": 1234
}
```
2. 运行接口模板
- 说明: 运行接口模板
- api: `/execute_api`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "api": 1234,
    "env": 3,
    "user_variables": [1, 3, 5, 9]
}
```
- Response
```json
{
    "success": true,
    "data": {
        "headers": {
            "Content-Type": "application/json"
        },
        "body": {
            "success": true
        },
        "status_code": 200
    }
}
```
3. 查看接口模板详情
- 说明: 查看接口模板详情
- api: `/api_details`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "id": 3 
}
```
- Response
```json
{
    "success": true,
    "data": {
        "info":{
            "name": "登录",
            "manager": 12,
            "author": 3,
            "module": 22,
            "status": 1,
            "path": "/login",
            "desc": "登录接口",
            "env": 3,
        },
        "request": {
            "method": "post",
            "headers": {
                "token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9",
                "Content-Type": "application/json"
            },
            "query": {

            },
            "body": {
                "account":123456,
                "password":123456
            },
            "file": {
                "file_id": 123,
                "param": {
                    "use_type": "SalaryImg"
                    }
            }
        }
    }
}
```
4. 编辑接口模板详情
- 说明: 编辑接口模板详情
- api: `/edit_details`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "data": {
        "info":{
            "name": "登录",
            "manager": 12,
            "author": 3,
            "module": 22,
            "status": 1,
            "path": "/login",
            "desc": "登录接口",
            "env": 3,
        },
        "request": {
            "method": "post",
            "headers": {
                "token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9",
                "Content-Type": "application/json"
            },
            "query": {

            },
            "body": {
                "account":123456,
                "password":123456
            },
            "file": {
                "file_id": 123,
                "param": {
                    "use_type": "SalaryImg"
                    }
            }
        }
    },
    "id": 123
}
```
- Response
```json
{
    "success": true
}
```
## 接口用例
2. 创建接口用例
- 说明: 创建接口用例
- api: `/relation_cases`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "id": 2
}
```
- Response
```json
{
    "data": {
        "cases": [
            {
                "id": 3,
                "name": "正常登录",
                "level": 1,
                "near_status": true,
                "desc": "这是个登录的正向用例"
            },
                        {
                "id": 4,
                "name": "密码错误登录",
                "level": 2,
                "near_status": true,
                "desc": "这是个登录的反向用例"
            }
        ]
    },
    "success": true
}
```
## 场景组合
1. 场景创建接口
- 说明: 创建场景
- api: `/suite/create`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "cases": [
        {"type": "case", "id": 12355, "switch": true}, 
        {"type": "suite", "id": 12345, "copy": true, "cases": [
            {"id": 5742, "switch": true}, 
            {"id": 5742, "switch": false}
            ]
        }, 
        {"type": "case", "id": 6666, "switch": true}
        ],
    "info": {
        "name": "smoke",
        "status": "已完成",
        "manager": 123,
        "author": 11,
        "level": 2,
        "desc": "这是个冒烟测试用例集",
    },
    "variable":{
        "account": "hello",
        "password": "world"
    },
    "skip": true
}
```
- Response
```json
{
    "success": true,
    "suite_id": 12454
}
```
2. 场景运行接口
- 说明: 运行场景
- api: `/execute_suite`
- method: post
- Response
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "suite_id": 12454
}
```
- Response
```json
{
    "success": true
}
```
## 环境
### 系统环境
1. 获取系统环境列表
- 说明: 获取系统环境列表
    - page_size如果为-1则是无限
- api: `/system_environment`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "project": 2,
    "page": 1,
    "page_size": -1
}
```
- Response
```json
{
    "data": {
        "list": [
            {
                "name": "测试环境",
                "desc": "这是个测试环境",
                "host": "172.16.16.50",
                "id": 2
            },
            {
                "name": "开发环境",
                "desc": "这是个开发环境",
                "host": "172.16.16.30",
                "id": 1
            }
        ]
    },
    "success": true,
    "next_page": null,
    "total_page": 1
}
```
### 用户变量
1. 获取用户环境列表
- 说明: 获取用户环境列表
    - page_size如果为-1则是无限
- api: `/user_environment`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "project": 2,
    "page": 1,
    "page_size": -1
}
```
- Response
```json
{
    "data": {
        "list": [
            {
                "name": "域名",
                "key": "host",
                "value": "127.0.0.1",
                "desc": "域名",
                "id": 1
            },
            {
                "name": "姓名",
                "key": "username",
                "value": "xiaoming",
                "desc": "姓名",
                "id": 2
            },
        ]
    },
    "success": true,
    "next_page": null,
    "total_page": 1
}
```

## 定时任务
## 测试报告
## 方法实现
# 系统设置
## 角色管理
1. 获取角色列表
- 说明: 获取角色列表
- api: `/role`
- method: get
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
- Response
```json
{
    "data": {
        "role": [
            {   
                "id": 1,
                "name": "admin",
                "author": 123,
                "autore_name": "xiaohong",
                "create_data": "2021-04-22 23:11:00",
                "update_date": "2021-04-23 15:22:13",
                "status": true
            },{
                "id": 2,
                "name": "tester",
                "author": 123,
                "autore_name": "xiaohong",
                "create_data": "2021-04-22 23:11:00",
                "update_date": "2021-04-23 15:22:13".
                "status": false
            },
        ]
    },
    "success": true
}
```
2. 增加角色
- 说明: 获取角色列表
- api: `/add_role`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "permission": {
        "project": [1, 2, 5],
        "permission_no": {
            "1": [11, 24, 26, 29],
            "2": [22, 24, 26],
            "3": []
        }
    },
    "name": "角色1",
    "description": "这是角色1"
}
```
- Response
```json
{
    "success": true
}
```
3. 冻结角色
- 说明: 冻结某个角色,关联用户全部冻结
- api: `/freeze_role`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "role_id":　30
}
```
- Response
```json
{
    "success": true
}
```
4. 获取角色权限
- 说明: 获取角色权限
- api: `/role_permission`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "role_id":　22
}
```
- Response
```json
{
    "data": {
        "permission": {
            "project": [1, 2, 5],
            "permission_no": {
                "1": [11, 24, 26, 29],
                "2": [22, 24, 26],
                "3": []
            }
        },
        "name": "角色1",
        "description": "这是角色1",
    },
    "success": true
}
```
5. 编辑角色
- 说明: 获取角色权限
- api: `/edit_role`
- method: update
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "role_id": 22,
    "permission": {
        "project": [1, 2, 5],
        "permission_no": {
            "1": [11, 24, 26, 29],
            "2": [22, 24, 26],
            "3": []
        }
    },
    "name": "角色1",
    "description": "这是角色1",
}
```
- Response
```json
{
    "success": true
}
```
## 用户管理
1. 获取用户列表
- 说明: 获取用户列表
- api: `/user_list`
- method: get
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
- Response
```json
{
    "data": [
        {
            "id": 1,
            "name": "小黄",
            "account": "xiaohuang",
            "phone": "13013018883",
            "email": "hello@gmail.com",
            "create_date": "2020-05-04 15:12:21",
            "role": 1,
            "status": true
        },
        {
            "id": 2,
            "name": "小红",
            "account": "xiaohong",
            "phone": "13013018884",
            "email": "world@gmail.com",
            "create_date": "2020-05-04 15:12:21",
            "role": 3,
            "status": true
        }
    ],
    "success": true
}
```
2. 增加用户
- 说明: 增加用户
- api: `/add_user`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "name": "小红",
    "account": "xiaohong",
    "phone": "13013018884",
    "email": "world@gmail.com",
    "role": 1,
}
```
- Response
```json
{
    "success": true
}
```
3. 冻结用户
- 说明: 增加用户
- api: `/freeze_user`
- method: post
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "id": 1
}
```
- Response
```json
{
    "success": true
}
```
4. 编辑用户
- 说明: 增加用户
- api: `/edit_user`
- method: update
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "id": 3,
    "name": "小红",
    "phone": "13013018884",
    "email": "world@gmail.com",
    "role": 1,
}
```
- Response
```json
{
    "success": true
}
```
5. 重置用户密码
- 说明: 恢复初始化密码
- api: `/reset_pwd`
- method: update
- Requset
    - header: `token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9`
```json
{
    "id": 3
}
```
- Response
```json
{
    "success": true
}
```