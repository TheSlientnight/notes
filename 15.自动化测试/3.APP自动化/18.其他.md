
# 1.按键事件
使用`Uiautomator2`测试框架的时候,如果需要进行按键事件,需要使用`press_keycode`.
```py
from appium import webdriver
import time

desired_caps = {
                "platformName": "Android",
                "deviceName": "emulator-5554",     # 设备名称
                "platformVersion": "5.1.1",     # android系统版本号
                "appPackage": "com.yipiao",   # app包名
                "appActivity": "com.yipiao.activity.LaunchActivity",   # 启动launch Activity
                "noReset": True,  # 不清空数据
                'automationName': 'Uiautomator2'  # toast 必须用Uiautomator2
                }
driver = webdriver.Remote("http://127.0.0.1:4723/wd/hub", desired_caps)

time.sleep(10)    # 启动时间等待，放长一点


# Uiautomator2使用keyevent事件报错
# driver.keyevent(4)    # back事件  code 4

# Uiautomator2使用press_keycode解决
driver.press_keycode(4)
```
```py
driver.press_keycode(4) #发送keycode，功能：按键 Uiautomator2使用keyevent事件报错
driver.keyevent(4) #发送keycode，功能：按键，与press_keycode无区别 Uiautomator2正常使用
driver.hide_keyboard() #iOS使用key_name隐藏，安卓不使用参数，功能：隐藏键盘
driver.long_press_keycode(4) #发送keycode，功能：长按键
```

# 2.九宫格解锁
现在九宫格会有两种展示方式,一种是九宫格整体都为一个view的,没办法对里面的点进行定位

另一种是每个点都可以定位.每个点都可以定位的比较好处理

## 整体为一个view的九宫格
```py
# 获取整体九宫格的位置

loc = element.location  # 起始坐标

size = element.size  # 九宫格的大小

height = size["height"]/6  # 将高分为6份

width = size["width"]/6  # 将宽分为6份

# 找到第一个位置的点(假如是第一个点)
start_x = loc["x"] + width
start_y = loc["y"] + height

# 以下是画了 第一行第一个  第二行第一个  第三行第二个
ta = TouchAction(driver)
ta.press(x=start_x, y=start_y).wait(200). \
    move_to(x=start_x, y=start_y+height*2).wait(200). \
    move_to(x=start_x+width*2, y=start_y+height*4).wait(200). \
    release().wait(200).\
    perform()
```

## 单个点的九宫格
先去查看node detail,查看九宫格的排序顺序
```py
images = driver.find_Elements(*loc)  # 通过九个点都共同的数据,获取九个点的element对象

# images的索引顺序需要在调试的时候注意下,并不相同
ta = TouchAction(driver)
ta.press(images[1]).wait(200).\
    move_to(images[4]).wait(200).\
    move_to(images[8]).wait(200).\
    release().wait(200).\
    perform()

```

# 3.权限授权

权限授权弹窗可通过定位元素,进行点击操作.

因为不同系统默认允许的权限不同,在使用设备允许程序前应手动安装查看需要允许几次.

如果存在设备间允许权限数量不同的情况, 通过下方函数默认进行五次点击.

```py
def always_allow(self, n)

    for i in range(n):
        loc = ("xpath", "//*[@text='始终允许']")
        try:
            e = WebDriverWait(driver, 1, 0.5).until(EC.presence_of_element_located(loc))
            e.click()
        except:
            pass
```

# 4.app输入中文

如果app需要输入中文,需要在启动的配置文件中修改以下配置
```py
desired_caps = {}
desired_caps['unicodeKeyboard']=True #使用Unicode编码方式发送字符串
desired_caps['resetKeyboard']=True #将键盘隐藏起来
```

# adb命令
- `adb --help`: 查看帮助
- `adb devices`: 查看设备
- `adb -s`: 指定设备
- `adb shell`: 进入设备shell
- `adb pull 手机路径 电脑路径`:从设备拉取
- `adb push 本机路径 手机路径`:推送到设备
- `adb install -r apk`: 覆盖安装
- `adb shell dumpsys activity`: 查看应用包名和类名(要过滤)
- `adb uninstall -k apk`: 卸载应用, -k是保留数据和缓存
- `adb kill-server`: 终止adb服务
- `adb start-server`: 开启adb服务
- `adb shell pm list package`: 列出系统所有的包名
- `adb logcat`: 查看日志
- `adb connect host:port`: 远程连接设备
- `adb disconnect host:port`: 断开设备
