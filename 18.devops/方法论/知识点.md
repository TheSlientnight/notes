# devops
## 1. DevOps是一种思想、一组最佳实践、以及一种文化
- 目的: 缩短系统开发的生命周期, 降本增效提质
- 过程: 将开发特性,质量保证,更新部署紧密的联系起来
- 行动: 促使开发、质量、运维之间的沟通、协作与整合
- 本质: 团队文化+流程+工具链

## 2. 落地困境
- 涉及的部门多（开发中心、质量控制部门、生产运行部门）；
- 流程改造复杂；(从传统瀑布流转成敏捷)
- 责任边界需要重新划分；
- 自动化工具链是核心问题。(自动化运维,自动化测试,自动化部署等)

## 3. CICD:
- Devops是CICD思想的延伸,CICD是Devops的基础核心
- CI(持续集成): 频繁地（一天多次）将代码集成到主干, 每次集成都通过自动化的构建（包括编译，发布，自动化测试）来验证。
    - 优点:
        - 快速发现错误。每完成一点更新，就集成到主干，可以快速发现错误，定位错误也比较容易。
        - 防止分支大幅偏离主干。如果不是经常集成，主干又在不断更新，会导致以后集成的难度变大，甚至难以集成。
    - 持续集成并不能消除Bug，而是让它们非常容易发现和改正
- CD(持续交付): 频繁的可持续的将软件的新版本，交付给质量团队或者用户，以供评审
    - 持续交付是持续部署的初级阶段,在部署层面上更多是手动部署
- CD(持续部署): 通过自动化部署的手段将软件功能频繁的进行交付
    - 持续部署是持续交付的最高阶段

## 4. 实现步骤
- Dev分支合并:
    1. 开发者提交合并请求
    2. gitlab的webhook通知jenkins
    3. 单元测试合格
    4. 合并代码
    5. 构建镜像
    6. 推送镜像到仓库
    7. 在dev环境拉取镜像
    8. 部署
- Test分支合并:
    1. 提交合并请求
    2. gitlab的webhook通知jenkins
    3. 单元测试合格
    4. 静态扫描
    5. 人工确认合并
    6. gitlab的webhook通知jenkins
    7. 构建镜像
    8. 推送镜像到仓库
    9. 在test环境拉取镜像
    10. 部署
    11. 自动化冒烟测试(不成功通知,不回滚)
- 其他环境同理

## 5. 团队实践
    1. 通用工具链(jenkins,confluence,k8s,jira等)由运维推动
    2. 专业工具链(例如:静态扫描,Sonar,自动化测试等)由相关职能部门推动
    3. 全员灌输devops理念,每个职能推出KOL,对实践进行推动和优化
    4. 依托自动化工具把开发、测试、发布、部署的过程整合，实现高度自动化与高效交付
    5. 采用敏捷开发流程
        1. 采用看板方法:
            - 早上每天站会,沟通情况(任务状态，计划，以及障碍)
            - 每个月开回顾会,反思以及制定接下来的行动计划
            - 发布计划会(上线前最后的确认)
            - 小项目组,快迭代的模式
            - 小颗粒度划分任务
    6. 相关职能部门推动自己的流程优化
        1. 开发:
            - 采用TDD开发模式
            - 制定代码合并标准
        2. 测试:
            - 推动自动化测试
            - 推动测试左右移
                - 左移(测试提前介入或赋能介入):
                    1. 质量文化推广
                    2. 质量体系建设
                    3. 赋能开发自测
                - 右移(部署运营阶段的持续监控):
                    1. 服务监控
                    2. 业务监控

## 6. 站会
站会的意义
1. 让大家有团队的意识，能够了解其他人在做什么？项目的进度是个什么情况。
2. 让团队帮助解决当前的阻塞问题，需要协调哪些问题。
3. 从软件测试角度，能帮助梳理项目中的存在问题，让我们在进行软件测试时重点关注。

站会的规则
1. 站会应该严格控制在15分钟内
2. 站会后小范围的讨论

## 7. 监控措施
1. PM 业务级监控
2. ops 资源级监控
3. 运营 舆情监控
4. 开发的日志监控 打点监控等